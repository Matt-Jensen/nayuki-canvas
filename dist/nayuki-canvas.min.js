!function(){"use strict";function t(t,e){var r=t.posX,n=t.posY,a=t.velX,o=t.velY;return{posX:r+a*e,posY:n+o*e,velX:.99*a+.3*(Math.random()-.5),velY:.99*o+.3*(Math.random()-.5)}}function e(t,e,r,n){return t?Math.max(e-n,0):Math.min(e+r,1)}function r(){var r=this.canvasElem,n=r.width,a=r.height,o=this.nodes,i=this.idealNumNodes,s=this.driftSpeed,u=this.config,d=u.FADE_IN_RATE,c=u.FADE_OUT_RATE,h=u.BORDER_FADE,p=n/Math.max(n,a),f=a/Math.max(n,a),l=[],g=function(t,e){return e>=i||t.posX<h||p-t.posX<h||t.posY<h||f-t.posY<h};o.map(function(r,n){Object.assign({},r,t(r,s)),r.opacity=e(g(r,n),r.opacity,d,c),r.opacity>0&&l.push(r)});for(var v=l.length;i>v;v++)l.push({posX:Math.random()*p,posY:Math.random()*f,radius:.015*(Math.pow(Math.random(),5)+.35),velX:0,velY:0,opacity:0});return l}function n(t,e){for(var r=0;r<t.length;r++){var n=t[r],a=n.nodeA===e.nodeA&&n.nodeB===e.nodeB,o=n.nodeA===e.nodeB&&n.nodeB===e.nodeA;if(a||o)return!0}return!1}function a(t,e){for(var r=[],n=g.create(e.length),a=0;a<t.length&&r.length<e.length-1;a++){var o=t[a],i=f.slicedToArray(o,3),s=i[1],u=i[2];n.mergeSets(s,u)&&r.push({nodeA:e[s],nodeB:e[u]})}return r}function o(t,e){for(var r=[],n=0;n<t.length;n++)for(var a=t[n],o=0;n>o;o++){var i=t[o],s=Math.hypot(a.posX-i.posX,a.posY-i.posY);s/=Math.pow(a.radius*i.radius,e),r.push([s,n,o])}return r.sort(function(t,e){var r=f.slicedToArray(t,1),n=r[0],a=f.slicedToArray(e,1),o=a[0];return o>n?-1:n>o?1:0})}function i(t,e,r,n){return t?Math.min(e.opacity+r,1):Math.max(e.opacity-n,0)}function s(t){return t.opacity>0&&t.nodeA.opacity>0&&t.nodeB.opacity>0}function u(t,e){var r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return function(){return t.length<e.length-1+r}}function d(){var t=0,e=this.nodes,r=this.edges,d=this.maxExtraEdges,c=this.radiiWeightPower,h=this.config,p=h.FADE_IN_RATE,f=h.FADE_OUT_RATE,l=[],g=o(e,c),v=a(g,e),y=u(v,e,d);for(t=0;t<g.length&&y();t++){var m={nodeA:e[g[t][1]],nodeB:e[g[t][2]]};n(v,m)||v.push(m)}r.map(function(t){var e=Object.assign({},t);e.opacity=i(n(v,e),e,p,f),s(e)&&l.push(e)});var E=u(l,e,d);for(t=0;t<v.length&&E();t++){var A=v[t];n(l,A)||(A.opacity=0,l.push(A))}return l}function c(){var t=0,e=[],r=this.repulsionForce,n=this.nodes;for(t=0;t<2*n.length;t++)e.push(0);for(t=0;t<n.length;t++)for(var a=n[t],o=0;t>o;o++){var i=n[o],s=a.posX-i.posX,u=a.posY-i.posY,d=s*s+u*u,c=r/(Math.sqrt(d)*(d+1e-5));s*=c,u*=c,e[2*t+0]+=s,e[2*t+1]+=u,e[2*o+0]-=s,e[2*o+1]-=u}for(t=0;t<n.length;t++)n[t].posX+=e[2*t+0],n[t].posY+=e[2*t+1]}function h(){var t=this.canvasElem,e=this.graphics,r=this.nodes,n=this.edges,a=y.create({canvasElem:t,graphics:e,nodes:r,edges:n});return e.fillStyle=a.background,e.fillRect(0,0,a.data.width,a.data.height),a.nodes.forEach(function(t){e.fillStyle=t.fill,e.beginPath(),e.arc.apply(e,f.toConsumableArray(t.arc)),e.fill()}),e.lineWidth=a.data.size/800,a.edges.forEach(function(t){e.strokeStyle=t.style,e.beginPath(),e.moveTo.apply(e,f.toConsumableArray(t.start)),e.lineTo.apply(e,f.toConsumableArray(t.end)),e.stroke()}),a}function p(){this.stepFrame();for(var t=0;300>t;t++)this.doForceField();this.edges=[],this.stepFrame(),this.nodes.concat(this.edges).forEach(function(t){t.opacity=1}),this.redrawCanvas()}var f={};f["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},f.slicedToArray=function(){function t(t,e){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(u){a=!0,o=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(a)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),f.toConsumableArray=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)};var l={getRepr:function(t){return this.parents[t]!==t&&(this.parents[t]=this.getRepr(this.parents[t])),this.parents[t]},mergeSets:function(t,e){var r=this.getRepr(t),n=this.getRepr(e);if(r===n)return!1;var a=this.ranks[r]-this.ranks[n];return a>=0?(0===a&&this.ranks[r]++,this.parents[n]=r):this.parents[r]=n,!0}},g={create:function(t){for(var e={parents:{value:[]},ranks:{value:[],writable:!0}},r=0;t>r;r++)e.parents.value.push(r),e.ranks.value.push(0);return Object.create(l,e)}},v={create:function(t){var e=Object.assign({startColor:"#575E85",stopColor:"#2E3145"},t);return Object.create({data:e},{radialGradient:{get:function(){var t=this.data,e=t.width,r=t.height,n=t.size,a=t.graphics,o=t.startColor,i=t.stopColor,s=a.createRadialGradient(e/2,r/2,0,e/2,r/2,n/2);return s.addColorStop(0,o),s.addColorStop(1,i),s}}})}},y={create:function(t){var e=Object.assign({width:t.canvasElem.width,height:t.canvasElem.height,size:Math.max(t.canvasElem.width,t.canvasElem.height)},t);return Object.create({data:e},{background:{get:function(){return v.create(this.data).radialGradient}},nodes:{get:function(){var t=this.data.size,e="129,139,197";return this.data.nodes.map(function(r){return{fill:"rgba("+e+","+r.opacity.toFixed(3)+")",arc:[r.posX*t,r.posY*t,r.radius*t,0,2*Math.PI]}})}},edges:{get:function(){var t=this.data.size,e="129,139,197";return this.data.edges.map(function(r){var n=r.nodeA,a=r.nodeB,o=n.posX-a.posX,i=n.posY-a.posY,s=Math.min(Math.min(n.opacity,a.opacity),r.opacity),u=Math.hypot(o,i);return o/=u,i/=u,u<=n.radius+a.radius?!1:{style:"rgba("+e+","+s.toFixed(3)+")",start:[(n.posX-o*n.radius)*t,(n.posY-i*n.radius)*t],end:[(a.posX+o*a.radius)*t,(a.posY+i*a.radius)*t]}}).filter(function(t){return t})}}})}},m={updateNodes:r,updateEdges:d,doForceField:c,redrawCanvas:h,initialize:p},E={mesh:0,balanced:.5,hubAndSpoke:1},A={create:function(t,e){if(t instanceof HTMLElement==!1||"CANVAS"!==t.nodeName)throw new Error("Nayuki Canvas requires a canvas DOM node as the first argument");var r=Object.assign({extraEdges:20,numNodes:70,networkStyle:"balanced",driftSpeed:1,repulsionForce:1,BORDER_FADE:-.02,FADE_IN_RATE:.06,FADE_OUT_RATE:.03,FRAME_INTERVAL:20},e),n=Object.assign({},{config:r},m),a=Object.create(n,{idealNumNodes:{get:function(){return parseInt(this.config.numNodes,10)}},maxExtraEdges:{get:function(){var t=this.config,e=t.extraEdges,r=t.numNodes;return Math.round(parseFloat(e)/100*r)}},radiiWeightPower:{get:function(){var t=this.config.networkStyle,e=E[t];return parseFloat(e)}},driftSpeed:{get:function(){var t=this.config.driftSpeed;return isNaN(t)?t:1e-4*t},set:function(t){return this.config.driftSpeed=parseFloat(t),this.driftSpeed}},repulsionForce:{get:function(){var t=this.config.repulsionForce;return isNaN(t)?t:1e-6*t},set:function(t){return this.config.repulsionForce=parseFloat(t),this.repulsionForce}}});return a.canvasElem=t,a.graphics=t.getContext("2d"),a.nodes=[],a.edges=[],a.stepFrame=function(){this.nodes=this.updateNodes(),this.edges=this.updateEdges(),this.doForceField(),this.redrawCanvas()},setInterval(function(){return a.stepFrame()},r.FRAME_INTERVAL),a}};"object"===("undefined"==typeof exports?"undefined":f["typeof"](exports))?module.exports=A:"function"==typeof define&&"undefined"!=typeof define.amd?define(function(){return A}):window&&!window.nayukiCanvas&&(window.nayukiCanvas=A)}();