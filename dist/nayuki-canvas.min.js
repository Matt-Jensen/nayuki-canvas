"use strict";function calcAllEdgeWeights(e){for(var t=[],o=0;o<e.length;o++)for(var n=e[o],r=0;o>r;r++){var a=e[r],i=Math.hypot(n.posX-a.posX,n.posY-a.posY);i/=Math.pow(n.radius*a.radius,radiiWeightPower),t.push([i,o,r])}return t.sort(function(e,t){var o=_slicedToArray(e,1),n=o[0],r=_slicedToArray(t,1),a=r[0];return a>n?-1:n>a?1:0}),t}function calcSpanningTree(e,t){for(var o=[],n=new DisjointSet(t.length),r=0;r<e.length&&o.length<t.length-1;r++){var a=e[r],i=a[1],s=a[2];n.mergeSets(i,s)&&o.push({nodeA:t[i],nodeB:t[s]})}return o}function containsEdge(e,t){for(var o=0;o<e.length;o++){var n=e[o];if(n.nodeA==t.nodeA&&n.nodeB==t.nodeB||n.nodeA==t.nodeB&&n.nodeB==t.nodeA)return!0}return!1}function doForceField(e){var t=0,o=[];for(t=0;t<2*e.length;t++)o.push(0);for(t=0;t<e.length;t++)for(var n=e[t],r=0;t>r;r++){var a=e[r],i=n.posX-a.posX,s=n.posY-a.posY,d=i*i+s*s,u=repulsionForce/(Math.sqrt(d)*(d+1e-5));i*=u,s*=u,o[2*t+0]+=i,o[2*t+1]+=s,o[2*r+0]-=i,o[2*r+1]-=s}for(t=0;t<e.length;t++)e[t].posX+=o[2*t+0],e[t].posY+=o[2*t+1]}function updateEdges(e,t){var o=0,n=calcAllEdgeWeights(e),r=calcSpanningTree(n,e);for(o=0;o<n.length&&r.length<e.length-1+maxExtraEdges;o++){var a={nodeA:e[n[o][1]],nodeB:e[n[o][2]]};containsEdge(r,a)||r.push(a)}n=null;var i=[];for(t.forEach(function(e){containsEdge(r,e)?e.opacity=Math.min(e.opacity+FADE_IN_RATE,1):e.opacity=Math.max(e.opacity-FADE_OUT_RATE,0),e.opacity>0&&e.nodeA.opacity>0&&e.nodeB.opacity>0&&i.push(e)}),o=0;o<r.length&&i.length<e.length-1+maxExtraEdges;o++){var s=r[o];containsEdge(i,s)||(s.opacity=0,i.push(s))}return i}function redrawCanvas(e,t,o,n){var r=e.width,a=e.height,i=Math.max(r,a),s=t.createRadialGradient(r/2,a/2,0,r/2,a/2,i/2);s.addColorStop(0,"#575E85"),s.addColorStop(1,"#2E3145"),t.fillStyle=s,t.fillRect(0,0,r,a),o.forEach(function(e){t.fillStyle="rgba(129,139,197,"+e.opacity.toFixed(3)+")",t.beginPath(),t.arc(e.posX*i,e.posY*i,e.radius*i,0,2*Math.PI),t.fill()}),t.lineWidth=i/800,n.forEach(function(e){var o=e.nodeA,n=e.nodeB,r=o.posX-n.posX,a=o.posY-n.posY,s=Math.hypot(r,a);if(s>o.radius+n.radius){r/=s,a/=s;var d=Math.min(Math.min(o.opacity,n.opacity),e.opacity);t.strokeStyle="rgba(129,139,197,"+d.toFixed(3)+")",t.beginPath(),t.moveTo((o.posX-r*o.radius)*i,(o.posY-a*o.radius)*i),t.lineTo((n.posX+r*n.radius)*i,(n.posY+a*n.radius)*i),t.stroke()}})}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},_slicedToArray=function(){function e(e,t){var o=[],n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(o.push(i.value),!t||o.length!==t);n=!0);}catch(d){r=!0,a=d}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),BORDER_FADE=-.02,FADE_IN_RATE$1=.06,FADE_OUT_RATE$1=.03,networkStyleKey={mesh:0,balanced:.5,hubAndSpoke:1},nayukiCanvas={create:function(e,t){if(e instanceof HTMLElement==!1||"CANVAS"!==e.nodeName)throw new Error("Nayuki Canvas requires a canvas DOM node as the first argument");var o=Object.assign({extraEdges:20,numNodes:70,networkStyle:"balanced",driftSpeed:1,repulsionForce:1},t),n=Object.assign({},{config:o},nayukiCanvas.core),r=Object.create(n,{idealNumNodes:{get:function(){return parseInt(this.config.numNodes,10)}},maxExtraEdges:{get:function(){var e=this.config,t=e.extraEdges,o=e.numNodes;return Math.round(parseFloat(t)/100*o)}},radiiWeightPower:{get:function(){var e=this.config.networkStyle,t=networkStyleKey[e];return parseFloat(t)}},driftSpeed:{get:function(){var e=this.config.driftSpeed;return isNaN(e)?void 0:1e-4*e},set:function(e){return this.config.driftSpeed=parseFloat(e),this.driftSpeed}},repulsionForce:{get:function(){var e=this.config.repulsionForce;return isNaN(e)?void 0:1e-6*e},set:function(e){return this.config.repulsionForce=parseFloat(e),this.repulsionForce}}});r.el=e;r.graphics=e.getContext("2d"),r.nodes=[],r.edges=[];return r},core:{updateNodes:function(e,t,o){var n=e/Math.max(e,t),r=t/Math.max(e,t),a=[];o.forEach(function(e,t){e.posX+=e.velX*driftSpeed,e.posY+=e.velY*driftSpeed,e.velX=.99*e.velX+.3*(Math.random()-.5),e.velY=.99*e.velY+.3*(Math.random()-.5),t>=idealNumNodes||e.posX<BORDER_FADE||n-e.posX<BORDER_FADE||e.posY<BORDER_FADE||r-e.posY<BORDER_FADE?e.opacity=Math.max(e.opacity-FADE_OUT_RATE$1,0):e.opacity=Math.min(e.opacity+FADE_IN_RATE$1,1),e.opacity>0&&a.push(e)});for(var i=a.length;i<idealNumNodes;i++)a.push({posX:Math.random()*n,posY:Math.random()*r,radius:.015*(Math.pow(Math.random(),5)+.35),velX:0,velY:0,opacity:0});return doForceField(a),a}}};"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=nayukiCanvas:"function"==typeof define&&"undefined"!=typeof define.amd?define(function(){return nayukiCanvas}):window&&!window.nayukiCanvas&&(window.nayukiCanvas=nayukiCanvas);
//# sourceMappingURL=nayuki-canvas.min.js.map
