!function(){"use strict";function t(){var t=this,e=this.canvasElem,r=e.width,n=e.height,a=this.nodes,i=this.idealNumNodes,o=this.BORDER_FADE,s=r/Math.max(r,n),u=n/Math.max(r,n),d=[],h=function(t,e){return e>=i||t.posX<o||s-t.posX<o||t.posY<o||u-t.posY<o};a.map(function(e,r){var n=!h(e,r);e.opacity=t._getOpacity(n,e),e.opacity>0&&d.push(e)});for(var c=d.length;i>c;c++)d.push({posX:Math.random()*s,posY:Math.random()*u,radius:.015*(Math.pow(Math.random(),5)+.35),velX:0,velY:0,opacity:0});return d}function e(t){for(var e={parents:{value:[]},ranks:{value:[],writable:!0}},r=0;t>r;r++)e.parents.value.push(r),e.ranks.value.push(0);return Object.create(g,e)}function r(t,e){for(var r=0;r<t.length;r++){var n=t[r],a=n.nodeA===e.nodeA&&n.nodeB===e.nodeB,i=n.nodeA===e.nodeB&&n.nodeB===e.nodeA;if(a||i)return!0}return!1}function n(t,r){for(var n=[],a=e(r.length),i=0;i<t.length&&n.length<r.length-1;i++){var o=t[i],s=y(o,3),u=s[1],d=s[2];a.mergeSets(u,d)&&n.push({nodeA:r[u],nodeB:r[d]})}return n}function a(t,e){for(var r=[],n=0;n<t.length;n++)for(var a=t[n],i=0;n>i;i++){var o=t[i],s=Math.hypot(a.posX-o.posX,a.posY-o.posY);s/=Math.pow(a.radius*o.radius,e),r.push([s,n,i])}return r.sort(function(t,e){var r=y(t,1),n=r[0],a=y(e,1),i=a[0];return i>n?-1:n>i?1:0})}function i(t){return JSON.parse(JSON.stringify(t))}function o(t){return t.opacity>0&&t.nodeA.opacity>0&&t.nodeB.opacity>0}function s(t,e){var r=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return function(){return t.length<e.length-1+r}}function u(){for(var t=this,e=this.nodes,i=this.edges,u=this.maxExtraEdges,d=this.radiiWeightPower,h=[],c=a(e,d),p=n(c,e),l=s(p,e,u),f=0;f<c.length&&l();f++){var g={nodeA:e[c[f][1]],nodeB:e[c[f][2]]};r(p,g)||p.push(g)}i.map(function(e){var n=Object.assign({},e),a=r(p,n);n.opacity=t._getOpacity(a,n),o(n)&&h.push(n)});for(var v=s(h,e,u),y=0;y<p.length&&v();y++){var m=p[y];r(h,m)||(m.opacity=0,h.push(m))}return h}function d(t,e,r){return Object.create(null,{nodeA:{value:t},nodeB:{value:e},repulsionForce:{value:r},x:{get:function(){var t=this.nodeA,e=this.nodeB;return t.posX-e.posX}},y:{get:function(){var t=this.nodeA,e=this.nodeB;return t.posY-e.posY}},distSqr:{get:function(){var t=this.x,e=this.y;return t*t+e*e}},factor:{get:function(){var t=this.distSqr,e=this.repulsionForce;return e/(Math.sqrt(t)*(t+1e-5))}},deltas:{get:function(){var t=this.x,e=this.y,r=this.factor;return{dx:t*r,dy:e*r}}}})}function h(){for(var t=arguments.length<=0||void 0===arguments[0]?this.nodes:arguments[0],e=arguments.length<=1||void 0===arguments[1]?this.repulsionForce:arguments[1],r=[],n=i(t),a=0;a<2*n.length;a++)r.push(0);return n.forEach(function(t,a){for(var i=0;a>i;i++){var o=d(t,n[i],e),s=o.deltas,u=s.dx,h=s.dy;r[2*a+0]+=u,r[2*a+1]+=h,r[2*i+0]-=u,r[2*i+1]-=h}}),r}function c(t,e){return e>t.nodeA.radius+t.nodeB.radius}function p(){var t=this.canvasElem,e=this.graphics,r=this.nodes,n=this.edges,a=A.create({canvasElem:t,graphics:e,nodes:r,edges:n});return e.fillStyle=a.background,e.fillRect(0,0,a.data.width,a.data.height),a.nodes.forEach(function(t){e.fillStyle=t.fill,e.beginPath(),e.arc.apply(e,m(t.arc)),e.fill()}),e.lineWidth=a.data.size/800,a.edges.forEach(function(t){e.strokeStyle=t.style,e.beginPath(),e.moveTo.apply(e,m(t.start)),e.lineTo.apply(e,m(t.end)),e.stroke()}),a}function l(t,e){var r=arguments.length<=2||void 0===arguments[2]?this.FADE_IN_RATE:arguments[2],n=arguments.length<=3||void 0===arguments[3]?this.FADE_OUT_RATE:arguments[3];return t?Math.min(e.opacity+r,1):Math.max(e.opacity-n,0)}function f(){for(var t=0;70>t;t++)this.stepFrame()}var g={getRepr:function(t){return this.parents[t]!==t&&(this.parents[t]=this.getRepr(this.parents[t])),this.parents[t]},mergeSets:function(t,e){var r=this.getRepr(t),n=this.getRepr(e);if(r===n)return!1;var a=this.ranks[r]-this.ranks[n];return a>=0?(0===a&&this.ranks[r]++,this.parents[n]=r):this.parents[r]=n,!0}},v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},y=function(){function t(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(u){a=!0,i=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(a)throw i}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),m=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},E={create:function(t){var e=Object.assign({startColor:"#575E85",stopColor:"#2E3145"},t);return Object.create({data:e},{radialGradient:{get:function(){var t=this.data,e=t.width,r=t.height,n=t.size,a=t.graphics,i=t.startColor,o=t.stopColor,s=a.createRadialGradient(e/2,r/2,0,e/2,r/2,n/2);return s.addColorStop(0,i),s.addColorStop(1,o),s}}})}},A={create:function(t){var e=Object.assign({width:t.canvasElem.width,height:t.canvasElem.height,size:Math.max(t.canvasElem.width,t.canvasElem.height)},t);return Object.create({data:e,frameBackground:E,isEdgeVisible:c},{background:{get:function(){return this.frameBackground.create(this.data).radialGradient}},nodes:{get:function(){var t=this.data.size,e="129,139,197";return this.data.nodes.map(function(r){return{fill:"rgba("+e+","+r.opacity.toFixed(3)+")",arc:[r.posX*t,r.posY*t,r.radius*t,0,2*Math.PI]}})}},edges:{get:function(){var t=this,e=this.data.size,r="129,139,197";return this.data.edges.map(function(n){var a=n.nodeA,i=n.nodeB,o=a.posX-i.posX,s=a.posY-i.posY,u=Math.min(Math.min(a.opacity,i.opacity),n.opacity),d=Math.hypot(o,s);return o/=d,s/=d,t.isEdgeVisible(n,d)===!1?!1:{style:"rgba("+r+","+u.toFixed(3)+")",start:[(a.posX-o*a.radius)*e,(a.posY-s*a.radius)*e],end:[(i.posX+o*i.radius)*e,(i.posY+s*i.radius)*e]}}).filter(function(t){return t})}}})}},b={mesh:0,balanced:.5,hubAndSpoke:1},w={create:function(e,r){if(e instanceof HTMLElement==!1||"CANVAS"!==e.nodeName)throw new Error("Nayuki Canvas requires a canvas element for the first argument");var n=Object.assign({extraEdges:20,numNodes:70,networkStyle:"balanced",repulsion:1,BORDER_FADE:-.02,FADE_IN_RATE:.06,FADE_OUT_RATE:.03,FRAME_INTERVAL:20},r),a={updateNodes:t,updateEdges:u,getNodeDeltas:h,redrawCanvas:p,_getOpacity:l,initialize:f},i=Object.create(a,{idealNumNodes:{get:function(){return parseInt(this.numNodes,10)}},maxExtraEdges:{get:function(){var t=this.extraEdges,e=this.numNodes;return Math.round(parseFloat(t)/100*e)}},radiiWeightPower:{get:function(){var t=this.networkStyle,e=b[t];return parseFloat(e)}},repulsionForce:{get:function(){var t=this.repulsion;return isNaN(t)?t:1e-6*t},set:function(t){return this.repulsion=parseFloat(t),this.repulsion}}});return Object.assign(i,n),i.canvasElem=e,i.graphics=e.getContext("2d"),i.nodes=[],i.edges=[],i.stepFrame=function(){this.nodes=this.updateNodes();var t=this.getNodeDeltas();return this.nodes.map(function(e,r){return e.posX+=t[2*r+0],e.posY+=t[2*r+1],e}),this.edges=this.updateEdges(),this.redrawCanvas(),this},setInterval(function(){return i.stepFrame()},n.FRAME_INTERVAL),i}};"object"===("undefined"==typeof exports?"undefined":v(exports))?module.exports=w:"function"==typeof define&&"undefined"!=typeof define.amd?define(function(){return w}):window&&!window.nayukiCanvas&&(window.nayukiCanvas=w)}();