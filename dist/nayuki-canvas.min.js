!function(){"use strict";function t(t,e){var r=t.posX,n=t.posY,o=t.velX,a=t.velY;return{posX:r+o*e,posY:n+a*e,velX:.99*o+.3*(Math.random()-.5),velY:.99*a+.3*(Math.random()-.5)}}function e(t,e,r,n){return t?Math.max(e-n,0):Math.min(e+r,1)}function r(){var r=this.canvasElem,n=r.width,o=r.height,a=this.nodes,i=this.idealNumNodes,s=this.driftSpeed,u=this.config,d=u.FADE_IN_RATE,h=u.FADE_OUT_RATE,p=u.BORDER_FADE,c=n/Math.max(n,o),f=o/Math.max(n,o),l=[],g=function(t,e){return e>=i||t.posX<p||c-t.posX<p||t.posY<p||f-t.posY<p};a.map(function(r,n){Object.assign({},r,t(r,s)),r.opacity=e(g(r,n),r.opacity,d,h),r.opacity>0&&l.push(r)});for(var v=l.length;i>v;v++)l.push({posX:Math.random()*c,posY:Math.random()*f,radius:.015*(Math.pow(Math.random(),5)+.35),velX:0,velY:0,opacity:0});return l}function n(t,e){for(var r=0;r<t.length;r++){var n=t[r],o=n.nodeA===e.nodeA&&n.nodeB===e.nodeB,a=n.nodeA===e.nodeB&&n.nodeB===e.nodeA;if(o||a)return!0}return!1}function o(t,e){for(var r=[],n=c.create(e.length),o=0;o<t.length&&r.length<e.length-1;o++){var a=t[o],i=h.slicedToArray(a,3),s=i[1],u=i[2];n.mergeSets(s,u)&&r.push({nodeA:e[s],nodeB:e[u]})}return r}function a(t,e){for(var r=[],n=0;n<t.length;n++)for(var o=t[n],a=0;n>a;a++){var i=t[a],s=Math.hypot(o.posX-i.posX,o.posY-i.posY);s/=Math.pow(o.radius*i.radius,e),r.push([s,n,a])}return r.sort(function(t,e){var r=h.slicedToArray(t,1),n=r[0],o=h.slicedToArray(e,1),a=o[0];return a>n?-1:n>a?1:0})}function i(){var t=this,e=0,r=this.nodes,i=this.edges,s=a(r,this.radiiWeightPower),u=o(s,r);for(e=0;e<s.length&&u.length<r.length-1+this.maxExtraEdges;e++){var d={nodeA:r[s[e][1]],nodeB:r[s[e][2]]};n(u,d)||u.push(d)}s=null;var h=[];for(i.forEach(function(e){n(u,e)?e.opacity=Math.min(e.opacity+t.config.FADE_IN_RATE,1):e.opacity=Math.max(e.opacity-t.config.FADE_OUT_RATE,0),e.opacity>0&&e.nodeA.opacity>0&&e.nodeB.opacity>0&&h.push(e)}),e=0;e<u.length&&h.length<r.length-1+this.maxExtraEdges;e++){var p=u[e];n(h,p)||(p.opacity=0,h.push(p))}return h}function s(){var t=0,e=[],r=this.repulsionForce,n=this.nodes;for(t=0;t<2*n.length;t++)e.push(0);for(t=0;t<n.length;t++)for(var o=n[t],a=0;t>a;a++){var i=n[a],s=o.posX-i.posX,u=o.posY-i.posY,d=s*s+u*u,h=r/(Math.sqrt(d)*(d+1e-5));s*=h,u*=h,e[2*t+0]+=s,e[2*t+1]+=u,e[2*a+0]-=s,e[2*a+1]-=u}for(t=0;t<n.length;t++)n[t].posX+=e[2*t+0],n[t].posY+=e[2*t+1]}function u(){var t=this.canvasElem,e=this.graphics,r=this.nodes,n=this.edges,o=t.width,a=t.height,i=Math.max(o,a),s=e.createRadialGradient(o/2,a/2,0,o/2,a/2,i/2);s.addColorStop(0,"#575E85"),s.addColorStop(1,"#2E3145"),e.fillStyle=s,e.fillRect(0,0,o,a),r.forEach(function(t){e.fillStyle="rgba(129,139,197,"+t.opacity.toFixed(3)+")",e.beginPath(),e.arc(t.posX*i,t.posY*i,t.radius*i,0,2*Math.PI),e.fill()}),e.lineWidth=i/800,n.forEach(function(t){var r=t.nodeA,n=t.nodeB,o=r.posX-n.posX,a=r.posY-n.posY,s=Math.hypot(o,a);if(s>r.radius+n.radius){o/=s,a/=s;var u=Math.min(Math.min(r.opacity,n.opacity),t.opacity);e.strokeStyle="rgba(129,139,197,"+u.toFixed(3)+")",e.beginPath(),e.moveTo((r.posX-o*r.radius)*i,(r.posY-a*r.radius)*i),e.lineTo((n.posX+o*n.radius)*i,(n.posY+a*n.radius)*i),e.stroke()}})}function d(){this.stepFrame();for(var t=0;300>t;t++)this.doForceField();this.edges=[],this.stepFrame(),this.nodes.concat(this.edges).forEach(function(t){t.opacity=1}),this.redrawCanvas()}var h={};h["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},h.slicedToArray=function(){function t(t,e){var r=[],n=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(u){o=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw a}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var p={getRepr:function(t){return this.parents[t]!==t&&(this.parents[t]=this.getRepr(this.parents[t])),this.parents[t]},mergeSets:function(t,e){var r=this.getRepr(t),n=this.getRepr(e);if(r===n)return!1;var o=this.ranks[r]-this.ranks[n];return o>=0?(0===o&&this.ranks[r]++,this.parents[n]=r):this.parents[r]=n,!0}},c={create:function(t){for(var e={parents:{value:[]},ranks:{value:[],writable:!0}},r=0;t>r;r++)e.parents.value.push(r),e.ranks.value.push(0);return Object.create(p,e)}},f={updateNodes:r,updateEdges:i,doForceField:s,redrawCanvas:u,initialize:d},l={mesh:0,balanced:.5,hubAndSpoke:1},g={create:function(t,e){if(t instanceof HTMLElement==!1||"CANVAS"!==t.nodeName)throw new Error("Nayuki Canvas requires a canvas DOM node as the first argument");var r=Object.assign({extraEdges:20,numNodes:70,networkStyle:"balanced",driftSpeed:1,repulsionForce:1,BORDER_FADE:-.02,FADE_IN_RATE:.06,FADE_OUT_RATE:.03,FRAME_INTERVAL:20},e),n=Object.assign({},{config:r},f),o=Object.create(n,{idealNumNodes:{get:function(){return parseInt(this.config.numNodes,10)}},maxExtraEdges:{get:function(){var t=this.config,e=t.extraEdges,r=t.numNodes;return Math.round(parseFloat(e)/100*r)}},radiiWeightPower:{get:function(){var t=this.config.networkStyle,e=l[t];return parseFloat(e)}},driftSpeed:{get:function(){var t=this.config.driftSpeed;return isNaN(t)?t:1e-4*t},set:function(t){return this.config.driftSpeed=parseFloat(t),this.driftSpeed}},repulsionForce:{get:function(){var t=this.config.repulsionForce;return isNaN(t)?t:1e-6*t},set:function(t){return this.config.repulsionForce=parseFloat(t),this.repulsionForce}}});return o.canvasElem=t,o.graphics=t.getContext("2d"),o.nodes=[],o.edges=[],o.stepFrame=function(){this.nodes=this.updateNodes(),this.edges=this.updateEdges(),this.doForceField(),this.redrawCanvas()},setInterval(function(){return o.stepFrame()},r.FRAME_INTERVAL),o}};"object"===("undefined"==typeof exports?"undefined":h["typeof"](exports))?module.exports=g:"function"==typeof define&&"undefined"!=typeof define.amd?define(function(){return g}):window&&!window.nayukiCanvas&&(window.nayukiCanvas=g)}();